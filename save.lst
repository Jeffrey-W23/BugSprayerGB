                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module save
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _SaveGameData
                                     11 	.globl _LoadGameData
                                     12 ;--------------------------------------------------------
                                     13 ; special function registers
                                     14 ;--------------------------------------------------------
                                     15 ;--------------------------------------------------------
                                     16 ; ram data
                                     17 ;--------------------------------------------------------
                                     18 	.area _DATA
    00000000                         19 _SaveGameData_highScore_10000_129:
    00000000                         20 	.ds 2
    00000002                         21 _SaveGameData_savedShots_10000_129:
    00000002                         22 	.ds 2
                                     23 ;--------------------------------------------------------
                                     24 ; ram data
                                     25 ;--------------------------------------------------------
                                     26 	.area _INITIALIZED
                                     27 ;--------------------------------------------------------
                                     28 ; absolute external ram data
                                     29 ;--------------------------------------------------------
                                     30 	.area _DABS (ABS)
                                     31 ;--------------------------------------------------------
                                     32 ; global & static initialisations
                                     33 ;--------------------------------------------------------
                                     34 	.area _HOME
                                     35 	.area _GSINIT
                                     36 	.area _GSFINAL
                                     37 	.area _GSINIT
                                     38 ;save.c:26: static UINT16 highScore = 0;
    00000000 AF               [ 4]   39 	xor	a, a
    00000001 21r00r00         [12]   40 	ld	hl, #_SaveGameData_highScore_10000_129
    00000004 22               [ 8]   41 	ld	(hl+), a
    00000005 77               [ 8]   42 	ld	(hl), a
                                     43 ;save.c:27: static UINT16 savedShots = 0;
    00000006 AF               [ 4]   44 	xor	a, a
    00000007 21r02r00         [12]   45 	ld	hl, #_SaveGameData_savedShots_10000_129
    0000000A 22               [ 8]   46 	ld	(hl+), a
    0000000B 77               [ 8]   47 	ld	(hl), a
                                     48 ;--------------------------------------------------------
                                     49 ; Home
                                     50 ;--------------------------------------------------------
                                     51 	.area _HOME
                                     52 	.area _HOME
                                     53 ;--------------------------------------------------------
                                     54 ; code
                                     55 ;--------------------------------------------------------
                                     56 	.area _CODE
                                     57 ;save.c:23: void SaveGameData(UINT16 nScore, UINT16 nShotsTaken) 
                                     58 ;	---------------------------------
                                     59 ; Function SaveGameData
                                     60 ; ---------------------------------
    00000000                         61 _SaveGameData::
                                     62 ;save.c:30: if (nScore > highScore || nShotsTaken != savedShots) 
    00000000 21r00r00         [12]   63 	ld	hl, #_SaveGameData_highScore_10000_129
    00000003 2A               [ 8]   64 	ld	a, (hl+)
    00000004 93               [ 4]   65 	sub	a, e
    00000005 7E               [ 8]   66 	ld	a, (hl)
    00000006 9A               [ 4]   67 	sbc	a, d
    00000007 38 0B            [12]   68 	jr	C, 00101$
    00000009 21r02r00         [12]   69 	ld	hl, #_SaveGameData_savedShots_10000_129
    0000000C 7E               [ 8]   70 	ld	a, (hl)
    0000000D 91               [ 4]   71 	sub	a, c
    0000000E 20 04            [12]   72 	jr	NZ, 00113$
    00000010 23               [ 8]   73 	inc	hl
    00000011 7E               [ 8]   74 	ld	a, (hl)
    00000012 90               [ 4]   75 	sub	a, b
    00000013 C8               [20]   76 	ret	Z
    00000014                         77 00113$:
    00000014                         78 00101$:
                                     79 ;save.c:32: highScore = nScore;
    00000014 21r00r00         [12]   80 	ld	hl, #_SaveGameData_highScore_10000_129
    00000017 73               [ 8]   81 	ld	(hl), e
    00000018 23               [ 8]   82 	inc	hl
    00000019 72               [ 8]   83 	ld	(hl), d
                                     84 ;save.c:33: savedShots = nShotsTaken;
    0000001A 21r02r00         [12]   85 	ld	hl, #_SaveGameData_savedShots_10000_129
    0000001D 71               [ 8]   86 	ld	(hl), c
    0000001E 23               [ 8]   87 	inc	hl
    0000001F 70               [ 8]   88 	ld	(hl), b
                                     89 ;save.c:36: *((volatile UINT8*)0x0000) = 0x0A;
    00000020 21 00 00         [12]   90 	ld	hl, #0x0000
    00000023 36 0A            [12]   91 	ld	(hl), #0x0a
                                     92 ;save.c:40: sram[0] = SAVE_MAGIC;    // magic number
    00000025 26 A0            [ 8]   93 	ld	h, #0xa0
    00000027 3E AA            [ 8]   94 	ld	a, #0xaa
    00000029 22               [ 8]   95 	ld	(hl+), a
    0000002A 36 55            [12]   96 	ld	(hl), #0x55
                                     97 ;save.c:41: sram[1] = highScore;     // high score
    0000002C 11 02 A0         [12]   98 	ld	de, #0xa002
    0000002F FAr00r00         [16]   99 	ld	a, (_SaveGameData_highScore_10000_129)
    00000032 12               [ 8]  100 	ld	(de), a
    00000033 13               [ 8]  101 	inc	de
    00000034 FAr01r00         [16]  102 	ld	a, (_SaveGameData_highScore_10000_129 + 1)
    00000037 12               [ 8]  103 	ld	(de), a
                                    104 ;save.c:42: sram[2] = savedShots;    // shots taken
    00000038 11 04 A0         [12]  105 	ld	de, #0xa004
    0000003B FAr02r00         [16]  106 	ld	a, (_SaveGameData_savedShots_10000_129)
    0000003E 12               [ 8]  107 	ld	(de), a
    0000003F 13               [ 8]  108 	inc	de
    00000040 FAr03r00         [16]  109 	ld	a, (_SaveGameData_savedShots_10000_129 + 1)
    00000043 12               [ 8]  110 	ld	(de), a
                                    111 ;save.c:45: *((volatile UINT8*)0x0000) = 0x00;
    00000044 65               [ 4]  112 	ld	h, l
    00000045 36 00            [12]  113 	ld	(hl), #0x00
                                    114 ;save.c:47: }
    00000047 C9               [16]  115 	ret
                                    116 ;save.c:56: void LoadGameData(UINT16* nScore, UINT16* nShotsTaken)
                                    117 ;	---------------------------------
                                    118 ; Function LoadGameData
                                    119 ; ---------------------------------
    00000048                        120 _LoadGameData::
    00000048 E8 FC            [16]  121 	add	sp, #-4
    0000004A F8 02            [12]  122 	ldhl	sp,	#2
    0000004C 73               [ 8]  123 	ld	(hl), e
    0000004D 23               [ 8]  124 	inc	hl
    0000004E 72               [ 8]  125 	ld	(hl), d
                                    126 ;save.c:59: *((volatile UINT8*)0x0000) = 0x0A;
    0000004F 21 00 00         [12]  127 	ld	hl, #0x0000
    00000052 36 0A            [12]  128 	ld	(hl), #0x0a
                                    129 ;save.c:63: if (sram[0] == SAVE_MAGIC) 
    00000054 26 A0            [ 8]  130 	ld	h, #0xa0
    00000056 2A               [ 8]  131 	ld	a,	(hl+)
    00000057 66               [ 8]  132 	ld	h, (hl)
    00000058 D6 AA            [ 8]  133 	sub	a, #0xaa
    0000005A 20 24            [12]  134 	jr	NZ, 00102$
    0000005C 7C               [ 4]  135 	ld	a, h
    0000005D D6 55            [ 8]  136 	sub	a, #0x55
    0000005F 20 1F            [12]  137 	jr	NZ, 00102$
                                    138 ;save.c:66: *nScore = sram[1];
    00000061 11 02 A0         [12]  139 	ld	de, #0xa002
    00000064 1A               [ 8]  140 	ld	a, (de)
    00000065 F8 00            [12]  141 	ldhl	sp,	#0
    00000067 22               [ 8]  142 	ld	(hl+), a
    00000068 13               [ 8]  143 	inc	de
    00000069 1A               [ 8]  144 	ld	a, (de)
    0000006A 22               [ 8]  145 	ld	(hl+), a
    0000006B 2A               [ 8]  146 	ld	a, (hl+)
    0000006C 5F               [ 4]  147 	ld	e, a
    0000006D 56               [ 8]  148 	ld	d, (hl)
    0000006E F8 00            [12]  149 	ldhl	sp,	#0
    00000070 2A               [ 8]  150 	ld	a, (hl+)
    00000071 12               [ 8]  151 	ld	(de), a
    00000072 13               [ 8]  152 	inc	de
    00000073 7E               [ 8]  153 	ld	a, (hl)
    00000074 12               [ 8]  154 	ld	(de), a
                                    155 ;save.c:67: *nShotsTaken = sram[2];
    00000075 21 04 A0         [12]  156 	ld	hl, #0xa004
    00000078 2A               [ 8]  157 	ld	a,	(hl+)
    00000079 66               [ 8]  158 	ld	h, (hl)
    0000007A 02               [ 8]  159 	ld	(bc), a
    0000007B 03               [ 8]  160 	inc	bc
    0000007C 7C               [ 4]  161 	ld	a, h
    0000007D 02               [ 8]  162 	ld	(bc), a
    0000007E 18 1E            [12]  163 	jr	00103$
    00000080                        164 00102$:
                                    165 ;save.c:74: *nScore = 0;
    00000080 F8 02            [12]  166 	ldhl	sp,	#2
    00000082 2A               [ 8]  167 	ld	a, (hl+)
    00000083 66               [ 8]  168 	ld	h, (hl)
    00000084 6F               [ 4]  169 	ld	l, a
    00000085 AF               [ 4]  170 	xor	a, a
    00000086 22               [ 8]  171 	ld	(hl+), a
    00000087 77               [ 8]  172 	ld	(hl), a
                                    173 ;save.c:75: *nShotsTaken = 0;
    00000088 AF               [ 4]  174 	xor	a, a
    00000089 02               [ 8]  175 	ld	(bc), a
    0000008A 03               [ 8]  176 	inc	bc
    0000008B 02               [ 8]  177 	ld	(bc), a
                                    178 ;save.c:76: sram[0] = SAVE_MAGIC;
    0000008C 21 00 A0         [12]  179 	ld	hl, #0xa000
    0000008F 3E AA            [ 8]  180 	ld	a, #0xaa
    00000091 22               [ 8]  181 	ld	(hl+), a
    00000092 36 55            [12]  182 	ld	(hl), #0x55
                                    183 ;save.c:77: sram[1] = 0;
    00000094 2E 02            [ 8]  184 	ld	l, #0x02
    00000096 AF               [ 4]  185 	xor	a, a
    00000097 22               [ 8]  186 	ld	(hl+), a
    00000098 77               [ 8]  187 	ld	(hl), a
                                    188 ;save.c:78: sram[2] = 0;
    00000099 2E 04            [ 8]  189 	ld	l, #0x04
    0000009B AF               [ 4]  190 	xor	a, a
    0000009C 22               [ 8]  191 	ld	(hl+), a
    0000009D 77               [ 8]  192 	ld	(hl), a
    0000009E                        193 00103$:
                                    194 ;save.c:82: *((volatile UINT8*)0x0000) = 0x00;
    0000009E 21 00 00         [12]  195 	ld	hl, #0x0000
    000000A1 36 00            [12]  196 	ld	(hl), #0x00
                                    197 ;save.c:83: }
    000000A3 E8 04            [16]  198 	add	sp, #4
    000000A5 C9               [16]  199 	ret
                                    200 	.area _CODE
                                    201 	.area _INITIALIZER
                                    202 	.area _CABS (ABS)
